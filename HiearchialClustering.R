Revised_Data <- read.csv("C:/Users/Wai_f/documents/Revised_Data.csv")
View(Revised_Data)
library(data.table)
Revised_Data1<-Revised_Data[,-c(1,2)]
library(reshape2)
Bakery_data <- Revised_Data1
Bakery_data$Count =1
View(Bakery_data)
data_pivot <- dcast(Bakery_data, Transaction~Revised_Item, fun.aggregate = sum, value.var = "Count")
data_clust <-data_pivot[,-c(1)]
smp_size <- floor(0.25*nrow(data_clust))
set.seed(100)
smp_data <- sample(seq_len(nrow(data_clust)), size = smp_size)
data_clust_smp<- data_clust[smp_data, ]
data_scale <- scale(data_clust_smp)
library(cluster)
agnes1<-agnes(data_scale, diss=FALSE, metric="euclidean", stand=TRUE, method="ward")
(d3 <- as.dendrogram(agnes1)) # 3 branches
plot(d3)
dim(data_scale)
library(NbClust)
clustsize<-NbClust(data_scale, diss=NULL, distance = "euclidean", min.nc=2, max.nc = 15, method = "ward.D2", index = "all")
cutree(agnes1,k=5)
dim(data_scale)
qr(data_scale)$rank
Data_Clean<-data_scale[,-c(4,13,15,23,28,33,34,45,50,58)]# remove no data columns
library(NbClust)
NBClust<-NbClust(data = Data_Clean, diss = NULL, distance = "euclidean", min.nc = 2, max.nc = 10, method = "ward.D", index = "all")
